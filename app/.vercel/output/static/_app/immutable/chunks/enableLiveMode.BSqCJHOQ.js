const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./browser.auIgopO1.js","./client.DH9XjiO8.js","./index.iYw6vxA5.js","./scheduler.Hmp2l1Hb.js","./preload-helper.D6kgxu3v.js","./index.BHOFYTYL.js"])))=>i.map(i=>d[i]);
import{_ as lt}from"./preload-helper.D6kgxu3v.js";import{l as S,b as Wr,f as Hr,m as B,d as me,O as oe,h as mt}from"./client.DH9XjiO8.js";const Nt=typeof navigator>"u"?!1:navigator.product==="ReactNative",Lt={timeout:Nt?6e4:12e4},zr=function(t){const e={...Lt,...typeof t=="string"?{url:t}:t};if(e.timeout=Wt(e.timeout),e.query){const{url:r,searchParams:n}=Br(e.url);for(const[s,i]of Object.entries(e.query)){if(i!==void 0)if(Array.isArray(i))for(const c of i)n.append(s,c);else n.append(s,i);const a=n.toString();a&&(e.url=`${r}?${a}`)}}return e.method=e.body&&!e.method?"POST":(e.method||"GET").toUpperCase(),e};function Br(t){const e=t.indexOf("?");if(e===-1)return{url:t,searchParams:new URLSearchParams};const r=t.slice(0,e),n=t.slice(e+1);if(!Nt)return{url:r,searchParams:new URLSearchParams(n)};if(typeof decodeURIComponent!="function")throw new Error("Broken `URLSearchParams` implementation, and `decodeURIComponent` is not defined");const s=new URLSearchParams;for(const i of n.split("&")){const[a,c]=i.split("=");a&&s.append(vt(a),vt(c||""))}return{url:r,searchParams:s}}function vt(t){return decodeURIComponent(t.replace(/\+/g," "))}function Wt(t){if(t===!1||t===0)return!1;if(t.connect||t.socket)return t;const e=Number(t);return isNaN(e)?Wt(Lt.timeout):{connect:e,socket:e}}const Vr=/^https?:\/\//i,Gr=function(t){if(!Vr.test(t.url))throw new Error(`"${t.url}" is not a valid URL`)};function Jr(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}const Qr=t=>function(e,r,...n){const s=e==="onError";let i=r;for(let a=0;a<t[e].length;a++){const c=t[e][a];if(i=c(i,...n),s&&!i)break}return i};function Kr(){const t=Object.create(null);let e=0;function r(s){const i=e++;return t[i]=s,function(){delete t[i]}}function n(s){for(const i in t)t[i](s)}return{publish:n,subscribe:r}}const Xr=["request","response","progress","error","abort"],bt=["processOptions","validateOptions","interceptRequest","finalizeOptions","onRequest","onResponse","onError","onReturn","onHeaders"];function Ht(t,e){const r=[],n=bt.reduce((i,a)=>(i[a]=i[a]||[],i),{processOptions:[zr],validateOptions:[Gr]});function s(i){const a=(v,w,g)=>{let y=v,m=w;if(!y)try{m=u("onResponse",w,g)}catch(C){m=null,y=C}y=y&&u("onError",y,g),y?c.error.publish(y):m&&c.response.publish(m)},c=Xr.reduce((v,w)=>(v[w]=Kr(),v),{}),u=Qr(n),d=u("processOptions",i);u("validateOptions",d);const o={options:d,channels:c,applyMiddleware:u};let l;const f=c.request.subscribe(v=>{l=e(v,(w,g)=>a(w,g,v))});c.abort.subscribe(()=>{f(),l&&l.abort()});const p=u("onReturn",c,o);return p===c&&c.request.publish(o),p}return s.use=function(i){if(!i)throw new Error("Tried to add middleware that resolved to falsey value");if(typeof i=="function")throw new Error("Tried to add middleware that was a function. It probably expects you to pass options to it.");if(i.onReturn&&n.onReturn.length>0)throw new Error("Tried to add new middleware with `onReturn` handler, but another handler has already been registered for this event");return bt.forEach(a=>{i[a]&&n[a].push(i[a])}),r.push(i),s},s.clone=()=>Ht(r,e),t.forEach(s.use),s}var tt=function(t){return t.replace(/^\s+|\s+$/g,"")},Yr=function(t){return Object.prototype.toString.call(t)==="[object Array]"},Zr=function(t){if(!t)return{};for(var e={},r=tt(t).split(`
`),n=0;n<r.length;n++){var s=r[n],i=s.indexOf(":"),a=tt(s.slice(0,i)).toLowerCase(),c=tt(s.slice(i+1));typeof e[a]>"u"?e[a]=c:Yr(e[a])?e[a].push(c):e[a]=[e[a],c]}return e},en=Jr(Zr),tn=Object.defineProperty,zt=t=>{throw TypeError(t)},rn=(t,e,r)=>e in t?tn(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,q=(t,e,r)=>rn(t,typeof e!="symbol"?e+"":e,r),Bt=(t,e,r)=>e.has(t)||zt("Cannot "+r),M=(t,e,r)=>(Bt(t,e,"read from private field"),r?r.call(t):e.get(t)),V=(t,e,r)=>e.has(t)?zt("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,r),j=(t,e,r,n)=>(Bt(t,e,"write to private field"),e.set(t,r),r),$e,Se,ee,Oe,U,Te,Re;class it{constructor(){q(this,"onabort"),q(this,"onerror"),q(this,"onreadystatechange"),q(this,"ontimeout"),q(this,"readyState",0),q(this,"response"),q(this,"responseText",""),q(this,"responseType",""),q(this,"status"),q(this,"statusText"),q(this,"withCredentials"),V(this,$e),V(this,Se),V(this,ee),V(this,Oe,{}),V(this,U),V(this,Te,{}),V(this,Re)}open(e,r,n){var s;j(this,$e,e),j(this,Se,r),j(this,ee,""),this.readyState=1,(s=this.onreadystatechange)==null||s.call(this),j(this,U,void 0)}abort(){M(this,U)&&M(this,U).abort()}getAllResponseHeaders(){return M(this,ee)}setRequestHeader(e,r){M(this,Oe)[e]=r}setInit(e,r=!0){j(this,Te,e),j(this,Re,r)}send(e){const r=this.responseType!=="arraybuffer",n={...M(this,Te),method:M(this,$e),headers:M(this,Oe),body:e};typeof AbortController=="function"&&M(this,Re)&&(j(this,U,new AbortController),typeof EventTarget<"u"&&M(this,U).signal instanceof EventTarget&&(n.signal=M(this,U).signal)),typeof document<"u"&&(n.credentials=this.withCredentials?"include":"omit"),fetch(M(this,Se),n).then(s=>{var i;return s.headers.forEach((a,c)=>{j(this,ee,M(this,ee)+`${c}: ${a}\r
`)}),this.status=s.status,this.statusText=s.statusText,this.readyState=3,(i=this.onreadystatechange)==null||i.call(this),r?s.text():s.arrayBuffer()}).then(s=>{var i;typeof s=="string"?this.responseText=s:this.response=s,this.readyState=4,(i=this.onreadystatechange)==null||i.call(this)}).catch(s=>{var i,a;if(s.name==="AbortError"){(i=this.onabort)==null||i.call(this);return}(a=this.onerror)==null||a.call(this,s)})}}$e=new WeakMap,Se=new WeakMap,ee=new WeakMap,Oe=new WeakMap,U=new WeakMap,Te=new WeakMap,Re=new WeakMap;const ot=typeof XMLHttpRequest=="function"?"xhr":"fetch",nn=ot==="xhr"?XMLHttpRequest:it,sn=(t,e)=>{var r;const n=t.options,s=t.applyMiddleware("finalizeOptions",n),i={},a=t.applyMiddleware("interceptRequest",void 0,{adapter:ot,context:t});if(a){const h=setTimeout(e,0,null,a);return{abort:()=>clearTimeout(h)}}let c=new nn;c instanceof it&&typeof s.fetch=="object"&&c.setInit(s.fetch,(r=s.useAbortSignal)!=null?r:!0);const u=s.headers,d=s.timeout;let o=!1,l=!1,f=!1;if(c.onerror=h=>{c instanceof it?y(h instanceof Error?h:new Error(`Request error while attempting to reach is ${s.url}`,{cause:h})):y(new Error(`Request error while attempting to reach is ${s.url}${h.lengthComputable?`(${h.loaded} of ${h.total} bytes transferred)`:""}`))},c.ontimeout=h=>{y(new Error(`Request timeout while attempting to reach ${s.url}${h.lengthComputable?`(${h.loaded} of ${h.total} bytes transferred)`:""}`))},c.onabort=()=>{g(!0),o=!0},c.onreadystatechange=()=>{w(),!(o||c.readyState!==4)&&c.status!==0&&C()},c.open(s.method,s.url,!0),c.withCredentials=!!s.withCredentials,u&&c.setRequestHeader)for(const h in u)u.hasOwnProperty(h)&&c.setRequestHeader(h,u[h]);return s.rawBody&&(c.responseType="arraybuffer"),t.applyMiddleware("onRequest",{options:s,adapter:ot,request:c,context:t}),c.send(s.body||null),d&&(i.connect=setTimeout(()=>v("ETIMEDOUT"),d.connect)),{abort:p};function p(){o=!0,c&&c.abort()}function v(h){f=!0,c.abort();const _=new Error(h==="ESOCKETTIMEDOUT"?`Socket timed out on request to ${s.url}`:`Connection timed out on request to ${s.url}`);_.code=h,t.channels.error.publish(_)}function w(){d&&(g(),i.socket=setTimeout(()=>v("ESOCKETTIMEDOUT"),d.socket))}function g(h){(h||o||c.readyState>=2&&i.connect)&&clearTimeout(i.connect),i.socket&&clearTimeout(i.socket)}function y(h){if(l)return;g(!0),l=!0,c=null;const _=h||new Error(`Network error while attempting to reach ${s.url}`);_.isNetworkError=!0,_.request=s,e(_)}function m(){return{body:c.response||(c.responseType===""||c.responseType==="text"?c.responseText:""),url:s.url,method:s.method,headers:en(c.getAllResponseHeaders()),statusCode:c.status,statusMessage:c.statusText}}function C(){if(!(o||l||f)){if(c.status===0){y(new Error("Unknown XHR error"));return}g(),l=!0,e(null,m())}}},on=(t=[],e=sn)=>Ht(t,e);var an={},_t={exports:{}},rt,Ct;function cn(){if(Ct)return rt;Ct=1;var t=1e3,e=t*60,r=e*60,n=r*24,s=n*7,i=n*365.25;rt=function(o,l){l=l||{};var f=typeof o;if(f==="string"&&o.length>0)return a(o);if(f==="number"&&isFinite(o))return l.long?u(o):c(o);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(o))};function a(o){if(o=String(o),!(o.length>100)){var l=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(o);if(l){var f=parseFloat(l[1]),p=(l[2]||"ms").toLowerCase();switch(p){case"years":case"year":case"yrs":case"yr":case"y":return f*i;case"weeks":case"week":case"w":return f*s;case"days":case"day":case"d":return f*n;case"hours":case"hour":case"hrs":case"hr":case"h":return f*r;case"minutes":case"minute":case"mins":case"min":case"m":return f*e;case"seconds":case"second":case"secs":case"sec":case"s":return f*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return f;default:return}}}}function c(o){var l=Math.abs(o);return l>=n?Math.round(o/n)+"d":l>=r?Math.round(o/r)+"h":l>=e?Math.round(o/e)+"m":l>=t?Math.round(o/t)+"s":o+"ms"}function u(o){var l=Math.abs(o);return l>=n?d(o,l,n,"day"):l>=r?d(o,l,r,"hour"):l>=e?d(o,l,e,"minute"):l>=t?d(o,l,t,"second"):o+" ms"}function d(o,l,f,p){var v=l>=f*1.5;return Math.round(o/f)+" "+p+(v?"s":"")}return rt}function un(t){r.debug=r,r.default=r,r.coerce=u,r.disable=i,r.enable=s,r.enabled=a,r.humanize=cn(),r.destroy=d,Object.keys(t).forEach(o=>{r[o]=t[o]}),r.names=[],r.skips=[],r.formatters={};function e(o){let l=0;for(let f=0;f<o.length;f++)l=(l<<5)-l+o.charCodeAt(f),l|=0;return r.colors[Math.abs(l)%r.colors.length]}r.selectColor=e;function r(o){let l,f=null,p,v;function w(...g){if(!w.enabled)return;const y=w,m=Number(new Date),C=m-(l||m);y.diff=C,y.prev=l,y.curr=m,l=m,g[0]=r.coerce(g[0]),typeof g[0]!="string"&&g.unshift("%O");let h=0;g[0]=g[0].replace(/%([a-zA-Z%])/g,(_,R)=>{if(_==="%%")return"%";h++;const O=r.formatters[R];if(typeof O=="function"){const k=g[h];_=O.call(y,k),g.splice(h,1),h--}return _}),r.formatArgs.call(y,g),(y.log||r.log).apply(y,g)}return w.namespace=o,w.useColors=r.useColors(),w.color=r.selectColor(o),w.extend=n,w.destroy=r.destroy,Object.defineProperty(w,"enabled",{enumerable:!0,configurable:!1,get:()=>f!==null?f:(p!==r.namespaces&&(p=r.namespaces,v=r.enabled(o)),v),set:g=>{f=g}}),typeof r.init=="function"&&r.init(w),w}function n(o,l){const f=r(this.namespace+(typeof l>"u"?":":l)+o);return f.log=this.log,f}function s(o){r.save(o),r.namespaces=o,r.names=[],r.skips=[];let l;const f=(typeof o=="string"?o:"").split(/[\s,]+/),p=f.length;for(l=0;l<p;l++)f[l]&&(o=f[l].replace(/\*/g,".*?"),o[0]==="-"?r.skips.push(new RegExp("^"+o.slice(1)+"$")):r.names.push(new RegExp("^"+o+"$")))}function i(){const o=[...r.names.map(c),...r.skips.map(c).map(l=>"-"+l)].join(",");return r.enable(""),o}function a(o){if(o[o.length-1]==="*")return!0;let l,f;for(l=0,f=r.skips.length;l<f;l++)if(r.skips[l].test(o))return!1;for(l=0,f=r.names.length;l<f;l++)if(r.names[l].test(o))return!0;return!1}function c(o){return o.toString().substring(2,o.toString().length-2).replace(/\.\*\?$/,"*")}function u(o){return o instanceof Error?o.stack||o.message:o}function d(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return r.enable(r.load()),r}var ln=un;(function(t,e){e.formatArgs=n,e.save=s,e.load=i,e.useColors=r,e.storage=a(),e.destroy=(()=>{let u=!1;return()=>{u||(u=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function r(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function n(u){if(u[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+u[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;const d="color: "+this.color;u.splice(1,0,d,"color: inherit");let o=0,l=0;u[0].replace(/%[a-zA-Z%]/g,f=>{f!=="%%"&&(o++,f==="%c"&&(l=o))}),u.splice(l,0,d)}e.log=console.debug||console.log||(()=>{});function s(u){try{u?e.storage.setItem("debug",u):e.storage.removeItem("debug")}catch{}}function i(){let u;try{u=e.storage.getItem("debug")}catch{}return!u&&typeof process<"u"&&"env"in process&&(u=an.DEBUG),u}function a(){try{return localStorage}catch{}}t.exports=ln(e);const{formatters:c}=t.exports;c.j=function(u){try{return JSON.stringify(u)}catch(d){return"[UnexpectedJSONParseError]: "+d.message}}})(_t,_t.exports);const dn=typeof Buffer>"u"?()=>!1:t=>Buffer.isBuffer(t);/*!
 * is-plain-object <https://github.com/jonschlinkert/is-plain-object>
 *
 * Copyright (c) 2014-2017, Jon Schlinkert.
 * Released under the MIT License.
 */function Et(t){return Object.prototype.toString.call(t)==="[object Object]"}function hn(t){if(Et(t)===!1)return!1;const e=t.constructor;if(e===void 0)return!0;const r=e.prototype;return!(Et(r)===!1||r.hasOwnProperty("isPrototypeOf")===!1)}const pn=["boolean","string","number"];function fn(){return{processOptions:t=>{const e=t.body;return!e||!(typeof e.pipe!="function"&&!dn(e)&&(pn.indexOf(typeof e)!==-1||Array.isArray(e)||hn(e)))?t:Object.assign({},t,{body:JSON.stringify(t.body),headers:Object.assign({},t.headers,{"Content-Type":"application/json"})})}}}function yn(t){return{onResponse:r=>{const n=r.headers["content-type"]||"",s=n.indexOf("application/json")!==-1;return!r.body||!n||!s?r:Object.assign({},r,{body:e(r.body)})},processOptions:r=>Object.assign({},r,{headers:Object.assign({Accept:"application/json"},r.headers)})};function e(r){try{return JSON.parse(r)}catch(n){throw n.message=`Failed to parsed response body as JSON: ${n.message}`,n}}}let ce={};typeof globalThis<"u"?ce=globalThis:typeof window<"u"?ce=window:typeof global<"u"?ce=global:typeof self<"u"&&(ce=self);var gn=ce;function wn(t={}){const e=t.implementation||gn.Observable;if(!e)throw new Error("`Observable` is not available in global scope, and no implementation was passed");return{onReturn:(r,n)=>new e(s=>(r.error.subscribe(i=>s.error(i)),r.progress.subscribe(i=>s.next(Object.assign({type:"progress"},i))),r.response.subscribe(i=>{s.next(Object.assign({type:"response"},i)),s.complete()}),r.request.publish(n),()=>r.abort.publish()))}}function mn(){return{onRequest:t=>{if(t.adapter!=="xhr")return;const e=t.request,r=t.context;"upload"in e&&"onprogress"in e.upload&&(e.upload.onprogress=n("upload")),"onprogress"in e&&(e.onprogress=n("download"));function n(s){return i=>{const a=i.lengthComputable?i.loaded/i.total*100:-1;r.channels.progress.publish({stage:s,percent:a,total:i.total,loaded:i.loaded,lengthComputable:i.lengthComputable})}}}}}var vn=Object.defineProperty,bn=(t,e,r)=>e in t?vn(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,we=(t,e,r)=>bn(t,typeof e!="symbol"?e+"":e,r);class _n{constructor(e){we(this,"__CANCEL__",!0),we(this,"message"),this.message=e}toString(){return`Cancel${this.message?`: ${this.message}`:""}`}}const $t=class{constructor(t){if(we(this,"promise"),we(this,"reason"),typeof t!="function")throw new TypeError("executor must be a function.");let e=null;this.promise=new Promise(r=>{e=r}),t(r=>{this.reason||(this.reason=new _n(r),e(this.reason))})}};we($t,"source",()=>{let t;return{token:new $t(e=>{t=e}),cancel:t}});var Vt=(t,e,r)=>r.method!=="GET"&&r.method!=="HEAD"?!1:t.isNetworkError||!1;const Cn=t=>t!==null&&typeof t=="object"&&typeof t.pipe=="function";var En=t=>{const e=t.maxRetries||5,r=t.retryDelay||$n,n=t.shouldRetry;return{onError:(s,i)=>{const a=i.options,c=a.maxRetries||e,u=a.retryDelay||r,d=a.shouldRetry||n,o=a.attemptNumber||0;if(Cn(a.body)||!d(s,o,a)||o>=c)return s;const l=Object.assign({},i,{options:Object.assign({},a,{attemptNumber:o+1})});return setTimeout(()=>i.channels.request.publish(l),u(o)),null}}};function $n(t){return 100*Math.pow(2,t)+Math.random()*100}const dt=(t={})=>En({shouldRetry:Vt,...t});dt.shouldRetry=Vt;var Gt={0:8203,1:8204,2:8205,3:8290,4:8291,5:8288,6:65279,7:8289,8:119155,9:119156,a:119157,b:119158,c:119159,d:119160,e:119161,f:119162},ht={0:8203,1:8204,2:8205,3:65279},Sn=new Array(4).fill(String.fromCodePoint(ht[0])).join("");function On(t){let e=JSON.stringify(t);return`${Sn}${Array.from(e).map(r=>{let n=r.charCodeAt(0);if(n>255)throw new Error(`Only ASCII edit info can be encoded. Error attempting to encode ${e} on character ${r} (${n})`);return Array.from(n.toString(4).padStart(4,"0")).map(s=>String.fromCodePoint(ht[s])).join("")}).join("")}`}function Tn(t){return!Number.isNaN(Number(t))||/[a-z]/i.test(t)&&!/\d+(?:[-:\/]\d+){2}(?:T\d+(?:[-:\/]\d+){1,2}(\.\d+)?Z?)?/.test(t)?!1:!!Date.parse(t)}function Rn(t){try{new URL(t,t.startsWith("/")?"https://acme.com":void 0)}catch{return!1}return!0}function An(t,e,r="auto"){return r===!0||r==="auto"&&(Tn(t)||Rn(t))?t:`${t}${On(e)}`}Object.fromEntries(Object.entries(ht).map(t=>t.reverse()));Object.fromEntries(Object.entries(Gt).map(t=>t.reverse()));var kn=`${Object.values(Gt).map(t=>`\\u{${t.toString(16)}}`).join("")}`,St=new RegExp(`[${kn}]{4,}`,"gu");function In(t){var e;return{cleaned:t.replace(St,""),encoded:((e=t.match(St))==null?void 0:e[0])||""}}function Pn(t){return t&&JSON.parse(In(JSON.stringify(t)).cleaned)}function Mn(t){return Pn(t)}var qn=Object.defineProperty,xn=(t,e,r)=>e in t?qn(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,W=(t,e,r)=>(xn(t,typeof e!="symbol"?e+"":e,r),r);class Fn extends Error{constructor(e){const r=Jt(e);super(r.message),W(this,"response"),W(this,"statusCode",400),W(this,"responseBody"),W(this,"details"),Object.assign(this,r)}}class Dn extends Error{constructor(e){const r=Jt(e);super(r.message),W(this,"response"),W(this,"statusCode",500),W(this,"responseBody"),W(this,"details"),Object.assign(this,r)}}function Jt(t){const e=t.body,r={response:t,statusCode:t.statusCode,responseBody:Ln(e,t),message:"",details:void 0};if(e.error&&e.message)return r.message=`${e.error} - ${e.message}`,r;if(jn(e)||Un(e)){const n=e.error.items||[],s=n.slice(0,5).map(a=>{var c;return(c=a.error)==null?void 0:c.description}).filter(Boolean);let i=s.length?`:
- ${s.join(`
- `)}`:"";return n.length>5&&(i+=`
...and ${n.length-5} more`),r.message=`${e.error.description}${i}`,r.details=e.error,r}return e.error&&e.error.description?(r.message=e.error.description,r.details=e.error,r):(r.message=e.error||e.message||Nn(t),r)}function jn(t){return je(t)&&je(t.error)&&t.error.type==="mutationError"&&typeof t.error.description=="string"}function Un(t){return je(t)&&je(t.error)&&t.error.type==="actionError"&&typeof t.error.description=="string"}function je(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)}function Nn(t){const e=t.statusMessage?` ${t.statusMessage}`:"";return`${t.method}-request to ${t.url} resulted in HTTP ${t.statusCode}${e}`}function Ln(t,e){return(e.headers["content-type"]||"").toLowerCase().indexOf("application/json")!==-1?JSON.stringify(t,null,2):t}const Wn={onResponse:t=>{if(t.statusCode>=500)throw new Dn(t);if(t.statusCode>=400)throw new Fn(t);return t}},Hn={onResponse:t=>{const e=t.headers["x-sanity-warning"];return(Array.isArray(e)?e:[e]).filter(Boolean).forEach(r=>console.warn(r)),t}};function zn(t){return on([dt({shouldRetry:Bn}),...t,Hn,fn(),yn(),mn(),Wn,wn({implementation:oe})])}function Bn(t,e,r){if(r.maxRetries===0)return!1;const n=r.method==="GET"||r.method==="HEAD",s=(r.uri||r.url).startsWith("/data/query"),i=t.response&&(t.response.statusCode===429||t.response.statusCode===502||t.response.statusCode===503);return(n||s)&&i?!0:dt.shouldRetry(t,e,r)}function Qt(t){if(typeof t=="string")return{id:t};if(Array.isArray(t))return{query:"*[_id in $ids]",params:{ids:t}};if(typeof t=="object"&&t!==null&&"query"in t&&typeof t.query=="string")return"params"in t&&typeof t.params=="object"&&t.params!==null?{query:t.query,params:t.params}:{query:t.query};const e=["* Document ID (<docId>)","* Array of document IDs","* Object containing `query`"].join(`
`);throw new Error(`Unknown selection - must be one of:

${e}`)}const Ot=["image","file"],Tt=["before","after","replace"],Kt=t=>{if(!/^(~[a-z0-9]{1}[-\w]{0,63}|[a-z0-9]{1}[-\w]{0,63})$/.test(t))throw new Error("Datasets can only contain lowercase characters, numbers, underscores and dashes, and start with tilde, and be maximum 64 characters")},Vn=t=>{if(!/^[-a-z0-9]+$/i.test(t))throw new Error("`projectId` can only contain only a-z, 0-9 and dashes")},Gn=t=>{if(Ot.indexOf(t)===-1)throw new Error(`Invalid asset type: ${t}. Must be one of ${Ot.join(", ")}`)},pe=(t,e)=>{if(e===null||typeof e!="object"||Array.isArray(e))throw new Error(`${t}() takes an object of properties`)},Xt=(t,e)=>{if(typeof e!="string"||!/^[a-z0-9_][a-z0-9_.-]{0,127}$/i.test(e)||e.includes(".."))throw new Error(`${t}(): "${e}" is not a valid document ID`)},Ue=(t,e)=>{if(!e._id)throw new Error(`${t}() requires that the document contains an ID ("_id" property)`);Xt(t,e._id)},Jn=(t,e,r)=>{const n="insert(at, selector, items)";if(Tt.indexOf(t)===-1){const s=Tt.map(i=>`"${i}"`).join(", ");throw new Error(`${n} takes an "at"-argument which is one of: ${s}`)}if(typeof e!="string")throw new Error(`${n} takes a "selector"-argument which must be a string`);if(!Array.isArray(r))throw new Error(`${n} takes an "items"-argument which must be an array`)},Yt=t=>{if(!t.dataset)throw new Error("`dataset` must be provided to perform queries");return t.dataset||""},Zt=t=>{if(typeof t!="string"||!/^[a-z0-9._-]{1,75}$/i.test(t))throw new Error("Tag can only contain alphanumeric characters, underscores, dashes and dots, and be between one and 75 characters long.");return t};var Qn=Object.defineProperty,Kn=(t,e,r)=>e in t?Qn(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Rt=(t,e,r)=>(Kn(t,typeof e!="symbol"?e+"":e,r),r),er=(t,e,r)=>{if(!e.has(t))throw TypeError("Cannot "+r)},se=(t,e,r)=>(er(t,e,"read from private field"),r?r.call(t):e.get(t)),tr=(t,e,r)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,r)},rr=(t,e,r,n)=>(er(t,e,"write to private field"),e.set(t,r),r);class nr{constructor(e,r={}){Rt(this,"selection"),Rt(this,"operations"),this.selection=e,this.operations=r}set(e){return this._assign("set",e)}setIfMissing(e){return this._assign("setIfMissing",e)}diffMatchPatch(e){return pe("diffMatchPatch",e),this._assign("diffMatchPatch",e)}unset(e){if(!Array.isArray(e))throw new Error("unset(attrs) takes an array of attributes to unset, non-array given");return this.operations=Object.assign({},this.operations,{unset:e}),this}inc(e){return this._assign("inc",e)}dec(e){return this._assign("dec",e)}insert(e,r,n){return Jn(e,r,n),this._assign("insert",{[e]:r,items:n})}append(e,r){return this.insert("after",`${e}[-1]`,r)}prepend(e,r){return this.insert("before",`${e}[0]`,r)}splice(e,r,n,s){const i=typeof n>"u"||n===-1,a=r<0?r-1:r,c=i?-1:Math.max(0,r+n),u=a<0&&c>=0?"":c,d=`${e}[${a}:${u}]`;return this.insert("replace",d,s||[])}ifRevisionId(e){return this.operations.ifRevisionID=e,this}serialize(){return{...Qt(this.selection),...this.operations}}toJSON(){return this.serialize()}reset(){return this.operations={},this}_assign(e,r,n=!0){return pe(e,r),this.operations=Object.assign({},this.operations,{[e]:Object.assign({},n&&this.operations[e]||{},r)}),this}_set(e,r){return this._assign(e,r,!1)}}var te;const Xn=class sr extends nr{constructor(e,r,n){super(e,r),tr(this,te,void 0),rr(this,te,n)}clone(){return new sr(this.selection,{...this.operations},se(this,te))}commit(e){if(!se(this,te))throw new Error("No `client` passed to patch, either provide one or pass the patch to a clients `mutate()` method");const r=typeof this.selection=="string",n=Object.assign({returnFirst:r,returnDocuments:!0},e);return se(this,te).mutate({patch:this.serialize()},n)}};te=new WeakMap;let fe=Xn;var re;const Yn=class ir extends nr{constructor(e,r,n){super(e,r),tr(this,re,void 0),rr(this,re,n)}clone(){return new ir(this.selection,{...this.operations},se(this,re))}commit(e){if(!se(this,re))throw new Error("No `client` passed to patch, either provide one or pass the patch to a clients `mutate()` method");const r=typeof this.selection=="string",n=Object.assign({returnFirst:r,returnDocuments:!0},e);return se(this,re).mutate({patch:this.serialize()},n)}};re=new WeakMap;let ye=Yn;var Zn=Object.defineProperty,es=(t,e,r)=>e in t?Zn(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,At=(t,e,r)=>(es(t,typeof e!="symbol"?e+"":e,r),r),or=(t,e,r)=>{if(!e.has(t))throw TypeError("Cannot "+r)},H=(t,e,r)=>(or(t,e,"read from private field"),r?r.call(t):e.get(t)),ar=(t,e,r)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,r)},cr=(t,e,r,n)=>(or(t,e,"write to private field"),e.set(t,r),r);const ur={returnDocuments:!1};class lr{constructor(e=[],r){At(this,"operations"),At(this,"trxId"),this.operations=e,this.trxId=r}create(e){return pe("create",e),this._add({create:e})}createIfNotExists(e){const r="createIfNotExists";return pe(r,e),Ue(r,e),this._add({[r]:e})}createOrReplace(e){const r="createOrReplace";return pe(r,e),Ue(r,e),this._add({[r]:e})}delete(e){return Xt("delete",e),this._add({delete:{id:e}})}transactionId(e){return e?(this.trxId=e,this):this.trxId}serialize(){return[...this.operations]}toJSON(){return this.serialize()}reset(){return this.operations=[],this}_add(e){return this.operations.push(e),this}}var G;const ts=class dr extends lr{constructor(e,r,n){super(e,n),ar(this,G,void 0),cr(this,G,r)}clone(){return new dr([...this.operations],H(this,G),this.trxId)}commit(e){if(!H(this,G))throw new Error("No `client` passed to transaction, either provide one or pass the transaction to a clients `mutate()` method");return H(this,G).mutate(this.serialize(),Object.assign({transactionId:this.trxId},ur,e||{}))}patch(e,r){const n=typeof r=="function";if(typeof e!="string"&&e instanceof ye)return this._add({patch:e.serialize()});if(n){const s=r(new ye(e,{},H(this,G)));if(!(s instanceof ye))throw new Error("function passed to `patch()` must return the patch");return this._add({patch:s.serialize()})}return this._add({patch:{id:e,...r}})}};G=new WeakMap;let hr=ts;var J;const rs=class pr extends lr{constructor(e,r,n){super(e,n),ar(this,J,void 0),cr(this,J,r)}clone(){return new pr([...this.operations],H(this,J),this.trxId)}commit(e){if(!H(this,J))throw new Error("No `client` passed to transaction, either provide one or pass the transaction to a clients `mutate()` method");return H(this,J).mutate(this.serialize(),Object.assign({transactionId:this.trxId},ur,e||{}))}patch(e,r){const n=typeof r=="function";if(typeof e!="string"&&e instanceof fe)return this._add({patch:e.serialize()});if(n){const s=r(new fe(e,{},H(this,J)));if(!(s instanceof fe))throw new Error("function passed to `patch()` must return the patch");return this._add({patch:s.serialize()})}return this._add({patch:{id:e,...r}})}};J=new WeakMap;let fr=rs;const ns="https://www.sanity.io/help/";function pt(t){return ns+t}function ss(t){let e=!1,r;return(...n)=>(e||(r=t(...n),e=!0),r)}const ve=t=>ss((...e)=>console.warn(t.join(" "),...e)),is=ve(["Because you set `withCredentials` to true, we will override your `useCdn`","setting to be false since (cookie-based) credentials are never set on the CDN"]),os=ve(["Since you haven't set a value for `useCdn`, we will deliver content using our","global, edge-cached API-CDN. If you wish to have content delivered faster, set","`useCdn: false` to use the Live API. Note: You may incur higher costs using the live API."]),as=ve(["The Sanity client is configured with the `perspective` set to `previewDrafts`, which doesn't support the API-CDN.","The Live API will be used instead. Set `useCdn: false` in your configuration to hide this warning."]),cs=ve(["You have configured Sanity client to use a token in the browser. This may cause unintentional security issues.",`See ${pt("js-client-browser-token")} for more information and how to hide this warning.`]),us=ve(["Using the Sanity client without specifying an API version is deprecated.",`See ${pt("js-client-api-version")}`]),ls="apicdn.sanity.io",ge={apiHost:"https://api.sanity.io",apiVersion:"1",useProjectHostname:!0,stega:{enabled:!1}},ds=["localhost","127.0.0.1","0.0.0.0"],hs=t=>ds.indexOf(t)!==-1;function ps(t){if(t==="1"||t==="X")return;const e=new Date(t);if(!(/^\d{4}-\d{2}-\d{2}$/.test(t)&&e instanceof Date&&e.getTime()>0))throw new Error("Invalid API version string, expected `1` or date in format `YYYY-MM-DD`")}const yr=function(t){switch(t){case"previewDrafts":case"published":case"raw":return;default:throw new TypeError("Invalid API perspective string, expected `published`, `previewDrafts` or `raw`")}},gr=(t,e)=>{const r={...e,...t,stega:{...typeof e.stega=="boolean"?{enabled:e.stega}:e.stega||ge.stega,...typeof t.stega=="boolean"?{enabled:t.stega}:t.stega||{}}};r.apiVersion||us();const n={...ge,...r},s=n.useProjectHostname;if(typeof Promise>"u"){const l=pt("js-client-promise-polyfill");throw new Error(`No native Promise-implementation found, polyfill needed - see ${l}`)}if(s&&!n.projectId)throw new Error("Configuration must contain `projectId`");if(typeof n.perspective=="string"&&yr(n.perspective),"encodeSourceMap"in n)throw new Error("It looks like you're using options meant for '@sanity/preview-kit/client'. 'encodeSourceMap' is not supported in '@sanity/client'. Did you mean 'stega.enabled'?");if("encodeSourceMapAtPath"in n)throw new Error("It looks like you're using options meant for '@sanity/preview-kit/client'. 'encodeSourceMapAtPath' is not supported in '@sanity/client'. Did you mean 'stega.filter'?");if(typeof n.stega.enabled!="boolean")throw new Error(`stega.enabled must be a boolean, received ${n.stega.enabled}`);if(n.stega.enabled&&n.stega.studioUrl===void 0)throw new Error("stega.studioUrl must be defined when stega.enabled is true");if(n.stega.enabled&&typeof n.stega.studioUrl!="string"&&typeof n.stega.studioUrl!="function")throw new Error(`stega.studioUrl must be a string or a function, received ${n.stega.studioUrl}`);const i=typeof window<"u"&&window.location&&window.location.hostname,a=i&&hs(window.location.hostname);i&&a&&n.token&&n.ignoreBrowserTokenWarning!==!0?cs():typeof n.useCdn>"u"&&os(),s&&Vn(n.projectId),n.dataset&&Kt(n.dataset),"requestTagPrefix"in n&&(n.requestTagPrefix=n.requestTagPrefix?Zt(n.requestTagPrefix).replace(/\.+$/,""):void 0),n.apiVersion=`${n.apiVersion}`.replace(/^v/,""),n.isDefaultApi=n.apiHost===ge.apiHost,n.useCdn===!0&&n.withCredentials&&is(),n.useCdn=n.useCdn!==!1&&!n.withCredentials,ps(n.apiVersion);const c=n.apiHost.split("://",2),u=c[0],d=c[1],o=n.isDefaultApi?ls:d;return n.useProjectHostname?(n.url=`${u}://${n.projectId}.${d}/v${n.apiVersion}`,n.cdnUrl=`${u}://${n.projectId}.${o}/v${n.apiVersion}`):(n.url=`${n.apiHost}/v${n.apiVersion}`,n.cdnUrl=n.url),n},fs="X-Sanity-Project-ID";function ys(t,e={}){const r={},n=e.token||t.token;n&&(r.Authorization=`Bearer ${n}`),!e.useGlobalApi&&!t.useProjectHostname&&t.projectId&&(r[fs]=t.projectId);const s=!!(typeof e.withCredentials>"u"?t.token||t.withCredentials:e.withCredentials),i=typeof e.timeout>"u"?t.timeout:e.timeout;return Object.assign({},e,{headers:Object.assign({},r,e.headers||{}),timeout:typeof i>"u"?5*60*1e3:i,proxy:e.proxy||t.proxy,json:!0,withCredentials:s,fetch:typeof e.fetch=="object"&&typeof t.fetch=="object"?{...t.fetch,...e.fetch}:e.fetch||t.fetch})}const wr=({query:t,params:e={},options:r={}})=>{const n=new URLSearchParams,{tag:s,includeMutations:i,returnQuery:a,...c}=r;s&&n.append("tag",s),n.append("query",t);for(const[u,d]of Object.entries(e))n.append(`$${u}`,JSON.stringify(d));for(const[u,d]of Object.entries(c))d&&n.append(u,`${d}`);return a===!1&&n.append("returnQuery","false"),i===!1&&n.append("includeMutations","false"),`?${n}`},gs=(t,e)=>t===!1?void 0:typeof t>"u"?e:t,ws=(t={})=>({dryRun:t.dryRun,returnIds:!0,returnDocuments:gs(t.returnDocuments,!0),visibility:t.visibility||"sync",autoGenerateArrayKeys:t.autoGenerateArrayKeys,skipCrossDatasetReferenceValidation:t.skipCrossDatasetReferenceValidation}),ft=t=>t.type==="response",ms=t=>t.body,vs=(t,e)=>t.reduce((r,n)=>(r[e(n)]=n,r),Object.create(null)),bs=11264;function mr(t,e,r,n,s={},i={}){const a="stega"in i?{...r||{},...typeof i.stega=="boolean"?{enabled:i.stega}:i.stega||{}}:r,c=a.enabled?Mn(s):s,u=i.filterResponse===!1?v=>v:v=>v.result,{cache:d,next:o,...l}={useAbortSignal:typeof i.signal<"u",resultSourceMap:a.enabled?"withKeyArraySelector":i.resultSourceMap,...i,returnQuery:i.filterResponse===!1&&i.returnQuery!==!1},f=typeof d<"u"||typeof o<"u"?{...l,fetch:{cache:d,next:o}}:l,p=ae(t,e,"query",{query:n,params:c},f);return a.enabled?p.pipe(Wr(Hr(lt(()=>Promise.resolve().then(()=>ai),void 0,import.meta.url).then(function(v){return v.stegaEncodeSourceMap$1}).then(({stegaEncodeSourceMap:v})=>v))),B(([v,w])=>{const g=w(v.result,v.resultSourceMap,a);return u({...v,result:g})})):p.pipe(B(u))}function vr(t,e,r,n={}){const s={uri:Z(t,"doc",r),json:!0,tag:n.tag};return be(t,e,s).pipe(me(ft),B(i=>i.body.documents&&i.body.documents[0]))}function br(t,e,r,n={}){const s={uri:Z(t,"doc",r.join(",")),json:!0,tag:n.tag};return be(t,e,s).pipe(me(ft),B(i=>{const a=vs(i.body.documents||[],c=>c._id);return r.map(c=>a[c]||null)}))}function _r(t,e,r,n){return Ue("createIfNotExists",r),Ye(t,e,r,"createIfNotExists",n)}function Cr(t,e,r,n){return Ue("createOrReplace",r),Ye(t,e,r,"createOrReplace",n)}function Er(t,e,r,n){return ae(t,e,"mutate",{mutations:[{delete:Qt(r)}]},n)}function $r(t,e,r,n){let s;r instanceof ye||r instanceof fe?s={patch:r.serialize()}:r instanceof hr||r instanceof fr?s=r.serialize():s=r;const i=Array.isArray(s)?s:[s],a=n&&n.transactionId||void 0;return ae(t,e,"mutate",{mutations:i,transactionId:a},n)}function Sr(t,e,r,n){const s=Array.isArray(r)?r:[r],i=n&&n.transactionId||void 0,a=n&&n.skipCrossDatasetReferenceValidation||void 0,c=n&&n.dryRun||void 0;return ae(t,e,"actions",{actions:s,transactionId:i,skipCrossDatasetReferenceValidation:a,dryRun:c},n)}function ae(t,e,r,n,s={}){const i=r==="mutate",a=r==="actions",c=r==="query",u=i||a?"":wr(n),d=!i&&!a&&u.length<bs,o=d?u:"",l=s.returnFirst,{timeout:f,token:p,tag:v,headers:w,returnQuery:g,lastLiveEventId:y}=s,m=Z(t,r,o),C={method:d?"GET":"POST",uri:m,json:!0,body:d?void 0:n,query:i&&ws(s),timeout:f,headers:w,token:p,tag:v,returnQuery:g,perspective:s.perspective,resultSourceMap:s.resultSourceMap,lastLiveEventId:Array.isArray(y)?y[0]:y,canUseCdn:c,signal:s.signal,fetch:s.fetch,useAbortSignal:s.useAbortSignal,useCdn:s.useCdn};return be(t,e,C).pipe(me(ft),B(ms),B(h=>{if(!i)return h;const _=h.results||[];if(s.returnDocuments)return l?_[0]&&_[0].document:_.map(k=>k.document);const R=l?"documentId":"documentIds",O=l?_[0]&&_[0].id:_.map(k=>k.id);return{transactionId:h.transactionId,results:_,[R]:O}}))}function Ye(t,e,r,n,s={}){const i={[n]:r},a=Object.assign({returnFirst:!0,returnDocuments:!0},s);return ae(t,e,"mutate",{mutations:[i]},a)}function be(t,e,r){var n,s;const i=r.url||r.uri,a=t.config(),c=typeof r.canUseCdn>"u"?["GET","HEAD"].indexOf(r.method||"GET")>=0&&i.indexOf("/data/")===0:r.canUseCdn;let u=((n=r.useCdn)!=null?n:a.useCdn)&&c;const d=r.tag&&a.requestTagPrefix?[a.requestTagPrefix,r.tag].join("."):r.tag||a.requestTagPrefix;if(d&&r.tag!==null&&(r.query={tag:Zt(d),...r.query}),["GET","HEAD","POST"].indexOf(r.method||"GET")>=0&&i.indexOf("/data/query/")===0){const f=(s=r.resultSourceMap)!=null?s:a.resultSourceMap;f!==void 0&&f!==!1&&(r.query={resultSourceMap:f,...r.query});const p=r.perspective||a.perspective;typeof p=="string"&&p!=="raw"&&(yr(p),r.query={perspective:p,...r.query},p==="previewDrafts"&&u&&(u=!1,as())),r.lastLiveEventId&&(r.query={...r.query,lastLiveEventId:r.lastLiveEventId}),r.returnQuery===!1&&(r.query={returnQuery:"false",...r.query})}const o=ys(a,Object.assign({},r,{url:yt(t,i,u)})),l=new oe(f=>e(o,a.requester).subscribe(f));return r.signal?l.pipe(_s(r.signal)):l}function x(t,e,r){return be(t,e,r).pipe(me(n=>n.type==="response"),B(n=>n.body))}function Z(t,e,r){const n=t.config(),s=Yt(n),i=`/${e}/${s}`;return`/data${r?`${i}/${r}`:i}`.replace(/\/($|\?)/,"$1")}function yt(t,e,r=!1){const{url:n,cdnUrl:s}=t.config();return`${r?s:n}/${e.replace(/^\//,"")}`}function _s(t){return e=>new oe(r=>{const n=()=>r.error(Es(t));if(t&&t.aborted){n();return}const s=e.subscribe(r);return t.addEventListener("abort",n),()=>{t.removeEventListener("abort",n),s.unsubscribe()}})}const Cs=!!globalThis.DOMException;function Es(t){var e,r;if(Cs)return new DOMException((e=t==null?void 0:t.reason)!=null?e:"The operation was aborted.","AbortError");const n=new Error((r=t==null?void 0:t.reason)!=null?r:"The operation was aborted.");return n.name="AbortError",n}var Or=(t,e,r)=>{if(!e.has(t))throw TypeError("Cannot "+r)},Ne=(t,e,r)=>(Or(t,e,"read from private field"),r?r.call(t):e.get(t)),Le=(t,e,r)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,r)},We=(t,e,r,n)=>(Or(t,e,"write to private field"),e.set(t,r),r),Ae,ke;class $s{constructor(e,r){Le(this,Ae,void 0),Le(this,ke,void 0),We(this,Ae,e),We(this,ke,r)}upload(e,r,n){return Tr(Ne(this,Ae),Ne(this,ke),e,r,n)}}Ae=new WeakMap,ke=new WeakMap;var Ie,Pe;class Ss{constructor(e,r){Le(this,Ie,void 0),Le(this,Pe,void 0),We(this,Ie,e),We(this,Pe,r)}upload(e,r,n){const s=Tr(Ne(this,Ie),Ne(this,Pe),e,r,n);return S(s.pipe(me(i=>i.type==="response"),B(i=>i.body.document)))}}Ie=new WeakMap,Pe=new WeakMap;function Tr(t,e,r,n,s={}){Gn(r);let i=s.extract||void 0;i&&!i.length&&(i=["none"]);const a=Yt(t.config()),c=r==="image"?"images":"files",u=Os(s,n),{tag:d,label:o,title:l,description:f,creditLine:p,filename:v,source:w}=u,g={label:o,title:l,description:f,filename:v,meta:i,creditLine:p};return w&&(g.sourceId=w.id,g.sourceName=w.name,g.sourceUrl=w.url),be(t,e,{tag:d,method:"POST",timeout:u.timeout||0,uri:`/assets/${c}/${a}`,headers:u.contentType?{"Content-Type":u.contentType}:{},query:g,body:n})}function Os(t,e){return typeof File>"u"||!(e instanceof File)?t:Object.assign({filename:t.preserveFilename===!1?void 0:e.name,contentType:e.type},t)}var Ts=(t,e)=>Object.keys(e).concat(Object.keys(t)).reduce((r,n)=>(r[n]=typeof t[n]>"u"?e[n]:t[n],r),{});const Rs=(t,e)=>e.reduce((r,n)=>(typeof t[n]>"u"||(r[n]=t[n]),r),{}),As=14800,ks=["includePreviousRevision","includeResult","includeMutations","visibility","effectFormat","tag"],Is={includeResult:!0};function Rr(t,e,r={}){const{url:n,token:s,withCredentials:i,requestTagPrefix:a}=this.config(),c=r.tag&&a?[a,r.tag].join("."):r.tag,u={...Ts(r,Is),tag:c},d=Rs(u,ks),o=wr({query:t,params:e,options:{tag:c,...d}}),l=`${n}${Z(this,"listen",o)}`;if(l.length>As)return new oe(w=>w.error(new Error("Query too large for listener")));const f=u.events?u.events:["mutation"],p=f.indexOf("reconnect")!==-1,v={};return(s||i)&&(v.withCredentials=!0),s&&(v.headers={Authorization:`Bearer ${s}`}),new oe(w=>{let g,y,m=!1,C=!1;_e();function h(){m||(D(),!m&&g.readyState===g.CLOSED&&(k(),clearTimeout(y),y=setTimeout(_e,100)))}function _(P){w.error(Ps(P))}function R(P){const F=Ar(P);return F instanceof Error?w.error(F):w.next(F)}function O(){m=!0,k(),w.complete()}function k(){g&&(g.removeEventListener("error",h),g.removeEventListener("channelError",_),g.removeEventListener("disconnect",O),f.forEach(P=>g.removeEventListener(P,R)),g.close())}function D(){p&&w.next({type:"reconnect"})}async function Ze(){const{default:P}=await lt(async()=>{const{default:et}=await import("./browser.auIgopO1.js").then(Lr=>Lr.b);return{default:et}},__vite__mapDeps([0,1,2,3,4,5]),import.meta.url);if(C)return;const F=new P(l,v);return F.addEventListener("error",h),F.addEventListener("channelError",_),F.addEventListener("disconnect",O),f.forEach(et=>F.addEventListener(et,R)),F}function _e(){Ze().then(P=>{P&&(g=P,C&&k())}).catch(P=>{w.error(P),wt()})}function wt(){m=!0,k(),C=!0}return wt})}function Ar(t){try{const e=t.data&&JSON.parse(t.data)||{};return Object.assign({type:t.type},e)}catch(e){return e}}function Ps(t){if(t instanceof Error)return t;const e=Ar(t);return e instanceof Error?e:new Error(Ms(e))}function Ms(t){return t.error?t.error.description?t.error.description:typeof t.error=="string"?t.error:JSON.stringify(t.error,null,2):t.message||"Unknown listener error"}var kr=(t,e,r)=>{if(!e.has(t))throw TypeError("Cannot "+r)},nt=(t,e,r)=>(kr(t,e,"read from private field"),r?r.call(t):e.get(t)),qs=(t,e,r)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,r)},xs=(t,e,r,n)=>(kr(t,e,"write to private field"),e.set(t,r),r);const kt="2021-03-26";var ne;class Ir{constructor(e){qs(this,ne,void 0),xs(this,ne,e)}events(){const e=nt(this,ne).config().apiVersion.replace(/^v/,"");if(e!=="X"&&e<kt)throw new Error(`The live events API requires API version ${kt} or later. The current API version is ${e}. Please update your API version to use this feature.`);const r=Z(nt(this,ne),"live/events"),n=new URL(nt(this,ne).getUrl(r,!1)),s=["restart","message"];return new oe(i=>{let a,c,u=!1,d=!1;v();function o(g){if(!u){if("data"in g){const y=It(g);i.error(new Error(y.message,{cause:y}))}a.readyState===a.CLOSED&&(f(),clearTimeout(c),c=setTimeout(v,100))}}function l(g){const y=It(g);return y instanceof Error?i.error(y):i.next(y)}function f(){if(a){a.removeEventListener("error",o);for(const g of s)a.removeEventListener(g,l);a.close()}}async function p(){const g=typeof EventSource>"u"?(await lt(async()=>{const{default:m}=await import("./browser.auIgopO1.js").then(C=>C.b);return{default:m}},__vite__mapDeps([0,1,2,3,4,5]),import.meta.url)).default:EventSource;if(d)return;const y=new g(n.toString());y.addEventListener("error",o);for(const m of s)y.addEventListener(m,l);return y}function v(){p().then(g=>{g&&(a=g,d&&f())}).catch(g=>{i.error(g),w()})}function w(){u=!0,f(),d=!0}return w})}}ne=new WeakMap;function It(t){try{const e=t.data&&JSON.parse(t.data)||{};return{type:t.type,id:t.lastEventId,...e}}catch(e){return e}}var Pr=(t,e,r)=>{if(!e.has(t))throw TypeError("Cannot "+r)},A=(t,e,r)=>(Pr(t,e,"read from private field"),r?r.call(t):e.get(t)),He=(t,e,r)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,r)},ze=(t,e,r,n)=>(Pr(t,e,"write to private field"),e.set(t,r),r),Q,K;class Fs{constructor(e,r){He(this,Q,void 0),He(this,K,void 0),ze(this,Q,e),ze(this,K,r)}create(e,r){return ie(A(this,Q),A(this,K),"PUT",e,r)}edit(e,r){return ie(A(this,Q),A(this,K),"PATCH",e,r)}delete(e){return ie(A(this,Q),A(this,K),"DELETE",e)}list(){return x(A(this,Q),A(this,K),{uri:"/datasets",tag:null})}}Q=new WeakMap,K=new WeakMap;var X,Y;class Ds{constructor(e,r){He(this,X,void 0),He(this,Y,void 0),ze(this,X,e),ze(this,Y,r)}create(e,r){return S(ie(A(this,X),A(this,Y),"PUT",e,r))}edit(e,r){return S(ie(A(this,X),A(this,Y),"PATCH",e,r))}delete(e){return S(ie(A(this,X),A(this,Y),"DELETE",e))}list(){return S(x(A(this,X),A(this,Y),{uri:"/datasets",tag:null}))}}X=new WeakMap,Y=new WeakMap;function ie(t,e,r,n,s){return Kt(n),x(t,e,{method:r,uri:`/datasets/${n}`,body:s,tag:null})}var Mr=(t,e,r)=>{if(!e.has(t))throw TypeError("Cannot "+r)},z=(t,e,r)=>(Mr(t,e,"read from private field"),r?r.call(t):e.get(t)),Be=(t,e,r)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,r)},Ve=(t,e,r,n)=>(Mr(t,e,"write to private field"),e.set(t,r),r),ue,le;class js{constructor(e,r){Be(this,ue,void 0),Be(this,le,void 0),Ve(this,ue,e),Ve(this,le,r)}list(e){const r=(e==null?void 0:e.includeMembers)===!1?"/projects?includeMembers=false":"/projects";return x(z(this,ue),z(this,le),{uri:r})}getById(e){return x(z(this,ue),z(this,le),{uri:`/projects/${e}`})}}ue=new WeakMap,le=new WeakMap;var de,he;class Us{constructor(e,r){Be(this,de,void 0),Be(this,he,void 0),Ve(this,de,e),Ve(this,he,r)}list(e){const r=(e==null?void 0:e.includeMembers)===!1?"/projects?includeMembers=false":"/projects";return S(x(z(this,de),z(this,he),{uri:r}))}getById(e){return S(x(z(this,de),z(this,he),{uri:`/projects/${e}`}))}}de=new WeakMap,he=new WeakMap;var qr=(t,e,r)=>{if(!e.has(t))throw TypeError("Cannot "+r)},Ge=(t,e,r)=>(qr(t,e,"read from private field"),r?r.call(t):e.get(t)),Je=(t,e,r)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,r)},Qe=(t,e,r,n)=>(qr(t,e,"write to private field"),e.set(t,r),r),Me,qe;class Ns{constructor(e,r){Je(this,Me,void 0),Je(this,qe,void 0),Qe(this,Me,e),Qe(this,qe,r)}getById(e){return x(Ge(this,Me),Ge(this,qe),{uri:`/users/${e}`})}}Me=new WeakMap,qe=new WeakMap;var xe,Fe;class Ls{constructor(e,r){Je(this,xe,void 0),Je(this,Fe,void 0),Qe(this,xe,e),Qe(this,Fe,r)}getById(e){return S(x(Ge(this,xe),Ge(this,Fe),{uri:`/users/${e}`}))}}xe=new WeakMap,Fe=new WeakMap;var Ws=Object.defineProperty,Hs=(t,e,r)=>e in t?Ws(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,I=(t,e,r)=>(Hs(t,typeof e!="symbol"?e+"":e,r),r),xr=(t,e,r)=>{if(!e.has(t))throw TypeError("Cannot "+r)},b=(t,e,r)=>(xr(t,e,"read from private field"),r?r.call(t):e.get(t)),Ke=(t,e,r)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,r)},Xe=(t,e,r,n)=>(xr(t,e,"write to private field"),e.set(t,r),r),N,$;const zs=class at{constructor(e,r=ge){I(this,"assets"),I(this,"datasets"),I(this,"live"),I(this,"projects"),I(this,"users"),Ke(this,N,void 0),Ke(this,$,void 0),I(this,"listen",Rr),this.config(r),Xe(this,$,e),this.assets=new $s(this,b(this,$)),this.datasets=new Fs(this,b(this,$)),this.live=new Ir(this),this.projects=new js(this,b(this,$)),this.users=new Ns(this,b(this,$))}clone(){return new at(b(this,$),this.config())}config(e){if(e===void 0)return{...b(this,N)};if(b(this,N)&&b(this,N).allowReconfigure===!1)throw new Error("Existing client instance cannot be reconfigured - use `withConfig(newConfig)` to return a new client");return Xe(this,N,gr(e,b(this,N)||{})),this}withConfig(e){const r=this.config();return new at(b(this,$),{...r,...e,stega:{...r.stega||{},...typeof(e==null?void 0:e.stega)=="boolean"?{enabled:e.stega}:(e==null?void 0:e.stega)||{}}})}fetch(e,r,n){return mr(this,b(this,$),b(this,N).stega,e,r,n)}getDocument(e,r){return vr(this,b(this,$),e,r)}getDocuments(e,r){return br(this,b(this,$),e,r)}create(e,r){return Ye(this,b(this,$),e,"create",r)}createIfNotExists(e,r){return _r(this,b(this,$),e,r)}createOrReplace(e,r){return Cr(this,b(this,$),e,r)}delete(e,r){return Er(this,b(this,$),e,r)}mutate(e,r){return $r(this,b(this,$),e,r)}patch(e,r){return new fe(e,r,this)}transaction(e){return new fr(e,this)}action(e,r){return Sr(this,b(this,$),e,r)}request(e){return x(this,b(this,$),e)}getUrl(e,r){return yt(this,e,r)}getDataUrl(e,r){return Z(this,e,r)}};N=new WeakMap,$=new WeakMap;let Bs=zs;var L,E;const Vs=class ct{constructor(e,r=ge){I(this,"assets"),I(this,"datasets"),I(this,"live"),I(this,"projects"),I(this,"users"),I(this,"observable"),Ke(this,L,void 0),Ke(this,E,void 0),I(this,"listen",Rr),this.config(r),Xe(this,E,e),this.assets=new Ss(this,b(this,E)),this.datasets=new Ds(this,b(this,E)),this.live=new Ir(this),this.projects=new Us(this,b(this,E)),this.users=new Ls(this,b(this,E)),this.observable=new Bs(e,r)}clone(){return new ct(b(this,E),this.config())}config(e){if(e===void 0)return{...b(this,L)};if(b(this,L)&&b(this,L).allowReconfigure===!1)throw new Error("Existing client instance cannot be reconfigured - use `withConfig(newConfig)` to return a new client");return this.observable&&this.observable.config(e),Xe(this,L,gr(e,b(this,L)||{})),this}withConfig(e){const r=this.config();return new ct(b(this,E),{...r,...e,stega:{...r.stega||{},...typeof(e==null?void 0:e.stega)=="boolean"?{enabled:e.stega}:(e==null?void 0:e.stega)||{}}})}fetch(e,r,n){return S(mr(this,b(this,E),b(this,L).stega,e,r,n))}getDocument(e,r){return S(vr(this,b(this,E),e,r))}getDocuments(e,r){return S(br(this,b(this,E),e,r))}create(e,r){return S(Ye(this,b(this,E),e,"create",r))}createIfNotExists(e,r){return S(_r(this,b(this,E),e,r))}createOrReplace(e,r){return S(Cr(this,b(this,E),e,r))}delete(e,r){return S(Er(this,b(this,E),e,r))}mutate(e,r){return S($r(this,b(this,E),e,r))}patch(e,r){return new ye(e,r,this)}transaction(e){return new hr(e,this)}action(e,r){return S(Sr(this,b(this,E),e,r))}request(e){return S(x(this,b(this,E),e))}dataRequest(e,r,n){return S(ae(this,b(this,E),e,r,n))}getUrl(e,r){return yt(this,e,r)}getDataUrl(e,r){return Z(this,e,r)}};L=new WeakMap,E=new WeakMap;let Fr=Vs;function Gs(t,e){const r=zn(t);return{requester:r,createClient:n=>new e((s,i)=>(i||r)({maxRedirects:0,maxRetries:n.maxRetries,retryDelay:n.retryDelay,...s}),n)}}var Js=[];Gs(Js,Fr);const Dr=/_key\s*==\s*['"](.*)['"]/;function Qs(t){return typeof t=="string"?Dr.test(t.trim()):typeof t=="object"&&"_key"in t}function jr(t){if(!Array.isArray(t))throw new Error("Path is not an array");return t.reduce((e,r,n)=>{const s=typeof r;if(s==="number")return`${e}[${r}]`;if(s==="string")return`${e}${n===0?"":"."}${r}`;if(Qs(r)&&r._key)return`${e}[_key=="${r._key}"]`;if(Array.isArray(r)){const[i,a]=r;return`${e}[${i}:${a}]`}throw new Error(`Unsupported path segment \`${JSON.stringify(r)}\``)},"")}const Pt={"\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t","'":"\\'","\\":"\\\\"},Mt={"\\f":"\f","\\n":`
`,"\\r":"\r","\\t":"	","\\'":"'","\\\\":"\\"};function Ks(t){return`$${t.map(e=>typeof e=="string"?`['${e.replace(/[\f\n\r\t'\\]/g,r=>Pt[r])}']`:typeof e=="number"?`[${e}]`:e._key!==""?`[?(@._key=='${e._key.replace(/['\\]/g,r=>Pt[r])}')]`:`[${e._index}]`).join("")}`}function qt(t){const e=[],r=/\['(.*?)'\]|\[(\d+)\]|\[\?\(@\._key=='(.*?)'\)\]/g;let n;for(;(n=r.exec(t))!==null;){if(n[1]!==void 0){const s=n[1].replace(/\\(\\|f|n|r|t|')/g,i=>Mt[i]);e.push(s);continue}if(n[2]!==void 0){e.push(parseInt(n[2],10));continue}if(n[3]!==void 0){const s=n[3].replace(/\\(\\')/g,i=>Mt[i]);e.push({_key:s,_index:-1});continue}}return e}function Ur(t){return t.map(e=>{if(typeof e=="string"||typeof e=="number")return e;if(e._key!=="")return{_key:e._key};if(e._index!==-1)return e._index;throw new Error(`invalid segment:${JSON.stringify(e)}`)})}function Xs(t){return t.map(e=>{if(typeof e=="string"||typeof e=="number")return e;if(e._index!==-1)return e._index;throw new Error(`invalid segment:${JSON.stringify(e)}`)})}function Ys(t,e){if(!(e!=null&&e.mappings))return;const r=Ks(Xs(t));if(e.mappings[r]!==void 0)return{mapping:e.mappings[r],matchedPath:r,pathSuffix:""};const n=Object.entries(e.mappings).filter(([c])=>r.startsWith(c)).sort(([c],[u])=>u.length-c.length);if(n.length==0)return;const[s,i]=n[0],a=r.substring(s.length);return{mapping:i,matchedPath:s,pathSuffix:a}}function Zs(t){return t!==null&&Array.isArray(t)}function xt(t){return typeof t=="object"&&t!==null}function De(t,e,r=[]){return Zs(t)?t.map((n,s)=>{if(xt(n)){const i=n._key;if(typeof i=="string")return De(n,e,r.concat({_key:i,_index:s}))}return De(n,e,r.concat(s))}):xt(t)?Object.fromEntries(Object.entries(t).map(([n,s])=>[n,De(s,e,r.concat(n))])):e(t,r)}function Nr(t,e,r){return De(t,(n,s)=>{if(typeof n!="string")return n;const i=Ys(s,e);if(!i)return n;const{mapping:a,matchedPath:c}=i;if(a.type!=="value"||a.source.type!=="documentValue")return n;const u=e.documents[a.source.document],d=e.paths[a.source.path],o=qt(c),l=qt(d).concat(s.slice(o.length));return r({sourcePath:l,sourceDocument:u,resultPath:s,value:n})})}const ut="drafts.";function ei(t){return t.startsWith(ut)?t.slice(ut.length):t}function ti(t){const{baseUrl:e,workspace:r="default",tool:n="default",id:s,type:i,path:a,projectId:c,dataset:u}=t;if(!e)throw new Error("baseUrl is required");if(!a)throw new Error("path is required");if(!s)throw new Error("id is required");if(e!=="/"&&e.endsWith("/"))throw new Error("baseUrl must not end with a slash");const d=r==="default"?void 0:r,o=n==="default"?void 0:n,l=ei(s),f=Array.isArray(a)?jr(Ur(a)):a,p=new URLSearchParams({baseUrl:e,id:l,type:i,path:f});d&&p.set("workspace",d),o&&p.set("tool",o),c&&p.set("projectId",c),u&&p.set("dataset",u),s.startsWith(ut)&&p.set("isDraft","");const v=[e==="/"?"":e];d&&v.push(d);const w=["mode=presentation",`id=${l}`,`type=${i}`,`path=${encodeURIComponent(f)}`];return o&&w.push(`tool=${o}`),v.push("intent","edit",`${w.join(";")}?${p}`),v.join("/")}function ri(t){let e=typeof t=="string"?t:t.baseUrl;return e!=="/"&&(e=e.replace(/\/$/,"")),typeof t=="string"?{baseUrl:e}:{...t,baseUrl:e}}const st=({sourcePath:t,resultPath:e,value:r})=>{if(si(r)||ii(r))return!1;const n=t.at(-1);return!(t.at(-2)==="slug"&&n==="current"||typeof n=="string"&&n.startsWith("_")||typeof n=="number"&&t.at(-2)==="marks"||n==="href"&&typeof t.at(-2)=="number"&&t.at(-3)==="markDefs"||n==="style"||n==="listItem"||t.some(s=>s==="meta"||s==="metadata"||s==="openGraph"||s==="seo")||Ft(t)||Ft(e)||typeof n=="string"&&ni.has(n))},ni=new Set(["color","colour","currency","email","format","gid","hex","href","hsl","hsla","icon","id","index","key","language","layout","link","linkAction","locale","lqip","page","path","ref","rgb","rgba","route","secret","slug","status","tag","template","theme","type","unit","url","username","variant","website"]);function si(t){return/^\d{4}-\d{2}-\d{2}/.test(t)?!!Date.parse(t):!1}function ii(t){try{new URL(t,t.startsWith("/")?"https://acme.com":void 0)}catch{return!1}return!0}function Ft(t){return t.some(e=>typeof e=="string"&&e.match(/type/i)!==null)}const Ce=20;function gt(t,e,r){var n,s,i,a,c,u,d,o,l;const{filter:f,logger:p,enabled:v}=r;if(!v){const y="config.enabled must be true, don't call this function otherwise";throw(n=p==null?void 0:p.error)==null||n.call(p,`[@sanity/client]: ${y}`,{result:t,resultSourceMap:e,config:r}),new TypeError(y)}if(!e)return(s=p==null?void 0:p.error)==null||s.call(p,"[@sanity/client]: Missing Content Source Map from response body",{result:t,resultSourceMap:e,config:r}),t;if(!r.studioUrl){const y="config.studioUrl must be defined";throw(i=p==null?void 0:p.error)==null||i.call(p,`[@sanity/client]: ${y}`,{result:t,resultSourceMap:e,config:r}),new TypeError(y)}const w={encoded:[],skipped:[]},g=Nr(t,e,({sourcePath:y,sourceDocument:m,resultPath:C,value:h})=>{if((typeof f=="function"?f({sourcePath:y,resultPath:C,filterDefault:st,sourceDocument:m,value:h}):st({sourcePath:y,resultPath:C,filterDefault:st,sourceDocument:m,value:h}))===!1)return p&&w.skipped.push({path:Dt(y),value:`${h.slice(0,Ce)}${h.length>Ce?"...":""}`,length:h.length}),h;p&&w.encoded.push({path:Dt(y),value:`${h.slice(0,Ce)}${h.length>Ce?"...":""}`,length:h.length});const{baseUrl:_,workspace:R,tool:O}=ri(typeof r.studioUrl=="function"?r.studioUrl(m):r.studioUrl);if(!_)return h;const{_id:k,_type:D,_projectId:Ze,_dataset:_e}=m;return An(h,{origin:"sanity.io",href:ti({baseUrl:_,workspace:R,tool:O,id:k,type:D,path:y,...!r.omitCrossDatasetReferenceData&&{dataset:_e,projectId:Ze}})},!1)});if(p){const y=w.skipped.length,m=w.encoded.length;if((y||m)&&((a=(p==null?void 0:p.groupCollapsed)||p.log)==null||a("[@sanity/client]: Encoding source map into result"),(c=p.log)==null||c.call(p,`[@sanity/client]: Paths encoded: ${w.encoded.length}, skipped: ${w.skipped.length}`)),w.encoded.length>0&&((u=p==null?void 0:p.log)==null||u.call(p,"[@sanity/client]: Table of encoded paths"),(d=(p==null?void 0:p.table)||p.log)==null||d(w.encoded)),w.skipped.length>0){const C=new Set;for(const{path:h}of w.skipped)C.add(h.replace(Dr,"0").replace(/\[\d+\]/g,"[]"));(o=p==null?void 0:p.log)==null||o.call(p,"[@sanity/client]: List of skipped paths",[...C.values()])}(y||m)&&((l=p==null?void 0:p.groupEnd)==null||l.call(p))}return g}function Dt(t){return jr(Ur(t))}var oi=Object.freeze({__proto__:null,stegaEncodeSourceMap:gt});const ai=Object.freeze(Object.defineProperty({__proto__:null,encodeIntoResult:Nr,stegaEncodeSourceMap:gt,stegaEncodeSourceMap$1:oi},Symbol.toStringTag,{value:"Module"}));let Ee;const ci=new Uint8Array(16);function ui(){if(!Ee&&(Ee=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Ee))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Ee(ci)}const T=[];for(let t=0;t<256;++t)T.push((t+256).toString(16).slice(1));var jt={randomUUID:typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function li(t,e,r){if(jt.randomUUID&&!e&&!t)return jt.randomUUID();const n=(t=t||{}).random||(t.rng||ui)();return n[6]=15&n[6]|64,n[8]=63&n[8]|128,function(s,i=0){return T[s[i+0]]+T[s[i+1]]+T[s[i+2]]+T[s[i+3]]+"-"+T[s[i+4]]+T[s[i+5]]+"-"+T[s[i+6]]+T[s[i+7]]+"-"+T[s[i+8]]+T[s[i+9]]+"-"+T[s[i+10]]+T[s[i+11]]+T[s[i+12]]+T[s[i+13]]+T[s[i+14]]+T[s[i+15]]}(n)}const di=["channel/disconnect","channel/response","channel/heartbeat"],hi=["handshake/syn","handshake/syn-ack","handshake/ack"],pi=t=>di.some(e=>e===t),Ut=t=>hi.some(e=>e===t),fi=({data:t={}})=>typeof t=="object"&&t!==null&&!Array.isArray(t)&&!("domain"in t)&&["id","type","from","to"].every(e=>e in t)&&t.type.startsWith("handshake/");function yi(t){const e=window.self!==window.top||window.opener,r={buffer:[],id:null,origin:null,source:null,status:"connecting"};function n(u,d){if(Ut(u)||pi(u)||r.status!=="connecting"&&r.status!=="reconnecting"){if(r.id&&r.origin&&r.source){const o={connectionId:r.id,data:d,domain:"sanity/channels",from:t.id,id:li(),to:t.connectTo,type:u};try{r.source.postMessage(o,{targetOrigin:r.origin})}catch{throw new Error(`Failed to postMessage '${o.id}' on '${t.id}'`)}}}else r.buffer.push({type:u,data:d})}function s(u){if(fi(u))console.error(`Visual editing package mismatch detected! Please ensure you are using the latest version of Sanity Studio and any packages listed here:
https://github.com/sanity-io/visual-editing`);else if(function(d){const{data:o}=d;return o.domain==="sanity/channels"&&o.to===t.id&&o.from===t.connectTo&&o.type!=="channel/response"}(u)){const{data:d}=u;if(r.origin&&u.origin!==r.origin)return;if(u.source&&r.source!==u.source&&(r.source=u.source),Ut(d.type)&&d.data){if(d.type==="handshake/syn")return r.origin=u.origin,r.id=d.data.id,c("connecting"),void n("handshake/syn-ack",{id:r.id});if(d.type==="handshake/ack"&&d.data.id===r.id)return void c("connected")}else if(d.connectionId===r.id&&u.origin===r.origin){if(d.type==="channel/disconnect")return void c("disconnected");{const o=[d.type,d.data];i.forEach(l=>{l(...o)}),n("channel/response",{responseTo:d.id})}return}}}const i=new Set,a=new Set;function c(u){r.status=u,a.forEach(d=>{d(u)}),u==="connected"&&function(){const d=[...r.buffer];r.buffer.splice(0,r.buffer.length),d.forEach(({type:o,data:l})=>{n(o,l)})}()}return window.addEventListener("message",s,!1),c("connecting"),{destroy:function(){["disconnected"].includes(r.status)||c("disconnected"),i.clear(),a.clear(),window.removeEventListener("message",s,!1)},inFrame:e,send:function(u,d){n(u,d)},subscribe:function(u){return i.add(u),()=>i.delete(u)},onStatusUpdate:function(u){return a.add(u),()=>a.delete(u)}}}function mi(t){const{client:e,setFetcher:r,onConnect:n,onDisconnect:s}=t;if(!(e&&e instanceof Fr))throw new Error(`Expected \`client\` to be an instance of SanityClient or SanityStegaClient: ${JSON.stringify(e)}`);const{projectId:i,dataset:a}=e.config(),c=mt("previewDrafts"),u=mt(!1),d=new Map,o=yi({id:"loaders",connectTo:"presentation"});let l;o.onStatusUpdate(y=>{y==="connected"?u.set(!0):y==="disconnected"&&u.set(!1)}),o.subscribe((y,m)=>{if(y==="loader/perspective"&&m.projectId===i&&m.dataset===a){if(m.perspective!=="published"&&m.perspective!=="previewDrafts")throw new Error(`Unsupported perspective: ${JSON.stringify(m.perspective)}`);c.set(m.perspective),g()}else if(y==="loader/query-change"&&m.projectId===i&&m.dataset===a){const{perspective:C,query:h,params:_}=m;m.result!==void 0&&m.resultSourceMap!==void 0&&e.config().stega.enabled?d.set(JSON.stringify({perspective:C,query:h,params:_}),{...m,result:gt(m.result,m.resultSourceMap,e.config().stega)}):d.set(JSON.stringify({perspective:C,query:h,params:_}),m),g()}});const f=u.listen(y=>{y?(l=r({hydrate:(m,C,h)=>{const _=(h==null?void 0:h.perspective)||c.get(),R=JSON.stringify({perspective:_,query:m,params:C}),O=d.get(R);return(O==null?void 0:O.result)!==void 0&&(O==null?void 0:O.resultSourceMap)!==void 0?{loading:!1,error:void 0,data:O.result,sourceMap:O.resultSourceMap,perspective:_}:{loading:u.value===!0&&(h==null?void 0:h.data)===void 0||(h==null?void 0:h.sourceMap)===void 0,error:void 0,data:h==null?void 0:h.data,sourceMap:h==null?void 0:h.sourceMap,perspective:(h==null?void 0:h.perspective)||"published"}},fetch:(m,C,h,_)=>{try{const R=v(m,C,h);if(_.signal.addEventListener("abort",()=>{R(),g()},{once:!0}),g(),h.setKey("error",void 0),_.signal.aborted)return}catch(R){h.setKey("error",R),h.setKey("loading",!1)}}}),n==null||n()):(l==null||l(),s==null||s())}),p=new Set,v=(y,m,C)=>{const h={query:y,params:m,$fetch:C};p.add(h),w();const _=setInterval(()=>w(!0),1e3);return()=>{clearInterval(_),p.delete(h),w()}},w=y=>{if(!o)throw new Error("No channel");const m=c.get();for(const{query:C,params:h,$fetch:_}of p)o.send("loader/query-listen",{projectId:i,dataset:a,perspective:m,query:C,params:h,heartbeat:1e3}),!y&&u.value===!0&&_.setKey("loading",!0),_.setKey("perspective",m)};function g(){var y,m;const C=c.get(),h=[];for(const{query:_,params:R,$fetch:O}of p){const k=JSON.stringify({perspective:C,query:_,params:R}),D=d.get(k);D&&(O.set({data:D.result,error:void 0,loading:!1,perspective:C,sourceMap:D.resultSourceMap}),h.push(...(m=(y=D.resultSourceMap)==null?void 0:y.documents)!=null?m:[]))}o==null||o.send("loader/documents",{projectId:i,dataset:a,perspective:C,documents:h})}return()=>{l==null||l(),f(),o.destroy()}}export{mi as enableLiveMode};
